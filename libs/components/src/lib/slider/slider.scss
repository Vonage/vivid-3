@use "../../../../shared/src/lib/sass/mixins/focus" as focus;
@use "../../../../shared/src/lib/sass/mixins/focus" as focus-variables;
@use "../../../../shared/src/lib/sass/utils" as utils;
@use "partials/variables" as variables;
@use "../../../../shared/src/lib/sass/mixins/connotation/config" with (
	$connotations: accent cta,
	$shades: primary,
	$default: accent
);
@use "../../../../shared/src/lib/sass/mixins/connotation" as connotation;
@use "../../../../shared/src/lib/sass/mixins/appearance/config" as appearance-config with (
	$appearances: filled,
	$default: filled
);
@use "../../../../shared/src/lib/sass/mixins/appearance" as appearance;
@use "../../../../shared/src/lib/sass/mixins/border-radius" as border-radius-variables;


$track-thickness: 2px;
:host {
	display: inline-block;
}

:host(:not([orientation="vertical"])) {
	inline-size: 100%;
}

:host([orientation="vertical"]) {
	block-size: 100%;
	min-block-size: calc(var(#{variables.$thumb-interaction-indicator-size}) * 5);
}

:host([disabled]) {
	cursor: not-allowed;
}

.control {
	@include connotation.connotation (slider);
	@include appearance.appearance;

	#{variables.$thumb-size}: 12px;
	#{variables.$thumb-interaction-indicator-size}: 36px;

	cursor: pointer;
	outline: none;
	user-select: none;

	.positioning-region {
		position: relative;
	}

	.track {
		position: absolute;
		border-radius: #{border-radius-variables.$border-radius-semi-condensed};
		background: var(#{variables.$track-background-color});

		&-start {
			position: absolute;
			left: 0;
			border-radius: inherit;
			background: var(#{variables.$track-start-background-color});
			block-size: 100%;
		}
	}

	&[aria-orientation="horizontal"] {
		block-size: var(#{variables.$thumb-interaction-indicator-size});
		inline-size: calc(100% - var(#{variables.$thumb-size}));
		margin-inline-start: calc(var(#{variables.$thumb-size}) / 2);
		min-inline-size: var(#{variables.$thumb-size});

		.track {
			top: calc((var(#{variables.$thumb-interaction-indicator-size}) - $track-thickness) / 2);
			right: 0;
			left: 0;
			block-size: $track-thickness;

			.mark {
				block-size: 4px;
				inline-size: 100%;
			}
		}
	}

	&[aria-orientation="vertical"] {
		margin-top: calc(var(#{variables.$thumb-interaction-indicator-size}) / 2);
		block-size: calc(100% - var(#{variables.$thumb-interaction-indicator-size}));
		inline-size: var(#{variables.$thumb-interaction-indicator-size});
		min-block-size: var(#{variables.$thumb-interaction-indicator-size});

		.positioning-region {
			block-size: 100%;
		}

		.track {
			left: calc((var(#{variables.$thumb-interaction-indicator-size}) - $track-thickness) / 2);
			block-size: 100%;
			inline-size: $track-thickness;

			.mark {
				block-size: 100%;
				inline-size: 4px;
			}
		}

		.track-start {
			top: 0;
			block-size: auto;
			inline-size: 100%;
		}
	}

	&.disabled {
		#{variables.$track-background-color}: var(#{utils.get-color-token(neutral-100)});
		#{variables.$track-start-background-color}: var(#{utils.get-color-token(neutral-300)});

		pointer-events: none;
	}

	&:not(.disabled) {
		#{variables.$track-background-color}: var(#{utils.get-color-token(neutral-300)});
		#{variables.$track-start-background-color}: var(#{appearance.get-appearance-token(fill)});
	}
}


.thumb-container {
	position: absolute;
	border-radius: #{border-radius-variables.$border-radius-full};
	block-size: var(#{variables.$thumb-interaction-indicator-size});
	cursor: inherit;
	inline-size: var(#{variables.$thumb-interaction-indicator-size});
	outline-color: transparent;
	touch-action: none;

	:focus-visible & {
		@include focus.focus;

		#{focus-variables.$focus-stroke-gap-color}: transparent;
		#{variables.$thumb-interaction-indicator-alpha}: 0.05;

		border-radius: #{border-radius-variables.$border-radius-full};
	}

	.control[aria-orientation="horizontal"] & {
		transform: translateX(calc(var(#{variables.$thumb-interaction-indicator-size}) / 2));
	}

	.control[aria-orientation="vertical"] & {
		transform: translateY(calc(var(#{variables.$thumb-interaction-indicator-size}) / 2));
	}

	.control:not(.disabled) & {
		&:hover {#{variables.$thumb-interaction-indicator-alpha}: 0.12;}
		&:active {#{variables.$thumb-interaction-indicator-alpha}: 0.25;}
	}


	&::before {
		position: absolute;
		display: block;
		border-radius: inherit;
		background-color: var(#{variables.$track-start-background-color});
		block-size: var(#{variables.$thumb-interaction-indicator-size});
		content: "";
		inline-size: var(#{variables.$thumb-interaction-indicator-size});
		opacity: var(#{variables.$thumb-interaction-indicator-alpha}, 0);
		transition: opacity 0.2s ease-out 0s;
	}

	&::after {
		position: absolute;
		display: block;
		border-radius: inherit;
		background-color: var(#{variables.$track-start-background-color});
		block-size: var(#{variables.$thumb-size});
		content: "";
		inline-size: var(#{variables.$thumb-size});
		inset: calc((var(#{variables.$thumb-interaction-indicator-size}) - var(#{variables.$thumb-size})) / 2);
	}
}

