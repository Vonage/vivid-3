@use 'sass:selector';
@use 'sass:list';
@use 'sass:map';

@use 'functions' as functions;
@use 'variables' as variables;
@use 'config' as config;


////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
$hover: ':hover, .hover';
$disabled: ':disabled, .disabled';
$readonly: ':readonly, .readonly';
$checked: ':checked, .checked';
$indeterminate: ':indeterminate, .indeterminate';
$selected: '.selected, [aria-current]';
$active: ':active, .active';
$error: '.error';
$success: '.success';

$selectors: (
  idle: '&',
  hover: '&:where(#{$hover}):where(:not(#{$disabled}))',
  disabled: '&:where(#{$disabled})',
  readonly: '&:where(#{$readonly}):where(:not(#{$disabled}, #{$hover}, #{$active}))',
  // selected: '&:where(#{$selected}):where(:not(#{$disabled}, #{$hover}))',
  // checked: '&:where(#{$checked}):where(:not(#{$disabled}))',
  selected: '&:where(#{$selected}):where(:not(#{$disabled}, #{$hover}, #{$active}))',
  checked: '&:where(#{$checked}):where(:not(#{$disabled}, #{$hover}, #{$active}))',
  indeterminate: '&:where(#{$indeterminate}):where(:not(#{$disabled}))',
  active: '&:where(#{$active}):where(:not(#{$disabled}))',
  error: '&:where(#{$error}):where(:not(#{$disabled}))',
	success: '&:where(#{$success}):where(:not(#{$disabled}))',
);

@mixin appearance {

  @each $state in config.$states {
    #{map.get($selectors, $state)} {

      $state-mapping: map.get(variables.$states-mapping, $state);

      @each $appearance in config.$appearances {
        $selector: if($appearance == config.$default, '&', '&.appearance-#{$appearance}');


        #{$selector} {
          $appearance-mapping: map.get($state-mapping, $appearance);
          @each $type, $key in $appearance-mapping {
            #{functions.get-appearance-token($type)}: $key;
          }
        }
      }
    }
  }
}

